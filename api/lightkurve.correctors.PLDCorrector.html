
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>PLDCorrector &#8212; Lightkurve</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <!-- Load bootstrap css and js (the js is needed for the navbar toggle) -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />


    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-69171-9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-69171-9');
    </script>

  </head><body>
<header>
<nav class="navbar navbar-expand-lg navbar-light border-bottom">
  <div class="container">
    <a class="navbar-brand" href="../index.html">Lightkurve v1.1</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample07" aria-controls="navbarsExample07" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsExample07">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
            
              <a class="nav-link" href="../quickstart.html">Quickstart</a>
            </li>
            
            <li class="nav-item">
            
              <a class="nav-link" href="../tutorials/index.html">Tutorials</a>
            </li>
            
            <li class="nav-item">
            
              <a class="nav-link" href="index.html">API</a>
            </li>
            
            <li class="nav-item">
            
              <a class="nav-link" href="../about/index.html">About</a>
            </li>
        
      </ul>

        <form class="form-inline my-2 my-md-0" action="../search.html" method="get">
            <input class="form-control" type="text" placeholder="Search" aria-label="Search" name="q" />
        </form>

        <!-- GitHub icon -->
        
          <a href="https://github.com/KeplerGO/Lightkurve">
            <svg class="github-icon" viewBox="0 0 16 16" version="1.1" height="22" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
          </a>
        
    </div>
  </div>
</nav>
</header>

<div class="container">
    
  <div class="section" id="pldcorrector">
<h1>PLDCorrector<a class="headerlink" href="#pldcorrector" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="lightkurve.correctors.PLDCorrector">
<em class="property">class </em><code class="descclassname">lightkurve.correctors.</code><code class="descname">PLDCorrector</code><span class="sig-paren">(</span><em>tpf</em><span class="sig-paren">)</span><a class="headerlink" href="#lightkurve.correctors.PLDCorrector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lightkurve.correctors.corrector.Corrector</span></code></p>
<p>Implements the Pixel Level Decorrelation (PLD) systematics removal method.</p>
<blockquote>
<div><p>Pixel Level Decorrelation (PLD) was developed by <a class="reference internal" href="#r333fd99d762c-1" id="id1"><span>[R333fd99d762c-1]</span></a> to remove
systematic noise caused by spacecraft jitter for the Spitzer
Space Telescope. It was adapted to K2 data by <a class="reference internal" href="#r333fd99d762c-2" id="id2"><span>[R333fd99d762c-2]</span></a> and <a class="reference internal" href="#r333fd99d762c-3" id="id3"><span>[R333fd99d762c-3]</span></a>
for the EVEREST pipeline <a class="reference internal" href="#r333fd99d762c-4" id="id4"><span>[R333fd99d762c-4]</span></a>.</p>
<p>For a detailed description and implementation of PLD, please refer to
these references. Lightkurve provides a reference implementation
of PLD that is less sophisticated than EVEREST, but is suitable
for quick-look analyses and detrending experiments.</p>
<p>Our simple implementation of PLD is performed by first calculating the
noise model for each cadence in time. This function goes up to arbitrary
order, and is represented by</p>
<div class="math notranslate nohighlight">
\[m_i = \alpha + \beta t_i + \gamma t_i^2 + \sum_l a_l \frac{f_{il}}{\sum_k f_{ik}} + \sum_l \sum_m b_{lm} \frac{f_{il}f_{im}}{\left( \sum_k f_{ik} \right)^2} + ...\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(m_i\)</span> is the noise model at time <span class="math notranslate nohighlight">\(t_i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_{il}\)</span> is the flux in the <span class="math notranslate nohighlight">\(l^\text{th}\)</span> pixel at time <span class="math notranslate nohighlight">\(t_i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_l\)</span> is the first-order PLD coefficient on the linear term</p></li>
<li><p><span class="math notranslate nohighlight">\(b_{lm}\)</span> is the second-order PLD coefficient on the <span class="math notranslate nohighlight">\(l^\text{th}\)</span>,
<span class="math notranslate nohighlight">\(m^\text{th}\)</span> pixel pair</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span> are the
Gaussian Process terms applied to capture long-period variability.</p></li>
</ul>
</div></blockquote>
<p>We perform Principal Component Analysis (PCA) to reduce the number of
vectors in our final model to limit the set to best capture instrumental
noise. With a PCA-reduced set of vectors, we can construct a design matrix
containing fractional pixel fluxes.</p>
<p>To solve for the PLD model, we need to minimize the difference squared</p>
<div class="math notranslate nohighlight">
\[\chi^2 = \sum_i \frac{(y_i - m_i)^2}{\sigma_i^2},\]</div>
<p>where <span class="math notranslate nohighlight">\(y_i\)</span> is the observed flux value at time <span class="math notranslate nohighlight">\(t_i\)</span>, by solving</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \chi^2}{\partial a_l} = 0.\]</div>
</div></blockquote>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r333fd99d762c-1"><span class="brackets"><a class="fn-backref" href="#id1">R333fd99d762c-1</a></span></dt>
<dd><p>Deming et al. (2015), ads:2015ApJ…805..132D.
(arXiv:1411.7404)</p>
</dd>
<dt class="label" id="r333fd99d762c-2"><span class="brackets"><a class="fn-backref" href="#id2">R333fd99d762c-2</a></span></dt>
<dd><p>Luger et al. (2016), ads:2016AJ….152..100L
(arXiv:1607.00524)</p>
</dd>
<dt class="label" id="r333fd99d762c-3"><span class="brackets"><a class="fn-backref" href="#id3">R333fd99d762c-3</a></span></dt>
<dd><p>Luger et al. (2018), ads:2018AJ….156…99L
(arXiv:1702.05488)</p>
</dd>
<dt class="label" id="r333fd99d762c-4"><span class="brackets"><a class="fn-backref" href="#id4">R333fd99d762c-4</a></span></dt>
<dd><p>EVEREST pipeline webpage, <a class="reference external" href="https://rodluger.github.io/everest">https://rodluger.github.io/everest</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Download the pixel data for GJ 9827 and obtain a PLD-corrected light curve:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">lightkurve</span> <span class="k">as</span> <span class="nn">lk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpf</span> <span class="o">=</span> <span class="n">lk</span><span class="o">.</span><span class="n">search_targetpixelfile</span><span class="p">(</span><span class="s2">&quot;GJ9827&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">download</span><span class="p">()</span> <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corrector</span> <span class="o">=</span> <span class="n">lk</span><span class="o">.</span><span class="n">PLDCorrector</span><span class="p">(</span><span class="n">tpf</span><span class="p">)</span> <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lc</span> <span class="o">=</span> <span class="n">corrector</span><span class="o">.</span><span class="n">correct</span><span class="p">()</span> <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>However, the above example will over-fit the small transits!
It is necessary to mask the transits using <code class="xref py py-obj docutils literal notranslate"><span class="pre">corrector.correct(cadence_mask=...)</span></code>.</p>
<p class="rubric">Methods Summary</p>
<table class="longtable docutils align-center">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lightkurve.correctors.PLDCorrector.correct" title="lightkurve.correctors.PLDCorrector.correct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correct</span></code></a>(self[, aperture_mask, cadence_mask, …])</p></td>
<td><p>Returns a PLD systematics-corrected LightCurve.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lightkurve.correctors.PLDCorrector.diagnose" title="lightkurve.correctors.PLDCorrector.diagnose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diagnose</span></code></a>(self)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lightkurve.correctors.PLDCorrector.interact" title="lightkurve.correctors.PLDCorrector.interact"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interact</span></code></a>(self)</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="method">
<dt id="lightkurve.correctors.PLDCorrector.correct">
<code class="descname">correct</code><span class="sig-paren">(</span><em>self</em>, <em>aperture_mask=None</em>, <em>cadence_mask=None</em>, <em>gp_timescale=30</em>, <em>use_gp=True</em>, <em>pld_order=2</em>, <em>n_pca_terms=10</em>, <em>pld_aperture_mask=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lightkurve.correctors.PLDCorrector.correct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a PLD systematics-corrected LightCurve.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>aperture_mask</strong><span class="classifier">array-like, ‘pipeline’, ‘all’, ‘threshold’, or None</span></dt><dd><p>A boolean array describing the aperture such that <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> means
that the pixel will be used to generate the raw flux light curve.
If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> or ‘all’ are passed, all pixels will be used.
If ‘pipeline’ is passed, the mask suggested by the official pipeline
will be returned.
If ‘threshold’ is passed, all pixels brighter than 3-sigma above
the median flux will be used.</p>
</dd>
<dt><strong>cadence_mask</strong><span class="classifier">array-like</span></dt><dd><p>A mask that will be applied to the cadences prior to constructing
the detrending model. For example, you can pass a boolean array
of length <code class="xref py py-obj docutils literal notranslate"><span class="pre">n_cadences</span></code> where <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> means that the cadence will be
included in the noise model. You may also pass an array of indices.
This option enables signals of interest (e.g. planet transits)
to be excluded from the noise model, which will prevent over-fitting.
By default, no cadences will be masked.</p>
</dd>
<dt><strong>gp_timescale</strong><span class="classifier">float</span></dt><dd><p>Gaussian Process time scale length term (<code class="xref py py-obj docutils literal notranslate"><span class="pre">tau</span></code>) used to define
length of fit variability in days.</p>
</dd>
<dt><strong>use_gp</strong><span class="classifier">boolean</span></dt><dd><p>Option to turn GP fitting on or off.  You would typically only set
this to False to speed up the correction (at the cost of precision),
or if you suspect the presence of systematic noise at long timescales.</p>
</dd>
<dt><strong>pld_order</strong><span class="classifier">int</span></dt><dd><p>The order of Pixel Level De-correlation to be performed. First order
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">n=1</span></code>) uses only the pixel fluxes to construct the design matrix.
Higher order populates the design matrix with columns constructed
from the products of pixel fluxes.</p>
</dd>
<dt><strong>n_pca_terms</strong><span class="classifier">int</span></dt><dd><p>Number of terms added to the design matrix from each order of PLD
when performing Principal Component Analysis for models higher than
first order. Increasing this value may provide higher precision at
the expense of computational time.</p>
</dd>
<dt><strong>pld_aperture_mask</strong><span class="classifier">array-like, ‘pipeline’, ‘all’, ‘threshold’, or None</span></dt><dd><p>A boolean array describing the aperture such that <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> means
that the pixel will be used when selecting the PLD basis vectors.
If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#all" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all</span></code></a> are passed in, all pixels will be used.
If ‘pipeline’ is passed, the mask suggested by the official pipeline
will be returned.
If ‘threshold’ is passed, all pixels brighter than 3-sigma above
the median flux will be used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>corrected_lightcurve</strong><span class="classifier"><a class="reference internal" href="lightkurve.lightcurve.LightCurve.html#lightkurve.lightcurve.LightCurve" title="lightkurve.lightcurve.LightCurve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LightCurve</span></code></a></span></dt><dd><p>Returns a corrected lightcurve object. Depending on the input, the
returned object will be a <code class="xref py py-obj docutils literal notranslate"><span class="pre">KeplerLightCurve</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">TessLightCurve</span></code>, or
general <code class="xref py py-obj docutils literal notranslate"><span class="pre">LightCurve</span></code> object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lightkurve.correctors.PLDCorrector.diagnose">
<code class="descname">diagnose</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#lightkurve.correctors.PLDCorrector.diagnose" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="lightkurve.correctors.PLDCorrector.interact">
<code class="descname">interact</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#lightkurve.correctors.PLDCorrector.interact" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


</div>
<div class="container" style="padding-top: 2em;">
    <hr>
    <p class="text-center">
      Created with ♥ by the Lightkurve collaboration.
                      Please <a href="about/citing.html">cite us</a> or
                      <a href="https://github.com/KeplerGO/Lightkurve">join us on GitHub.</a>
    </p>
</div>
  </body>
</html>