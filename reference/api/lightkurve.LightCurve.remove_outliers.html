
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lightkurve.LightCurve.remove_outliers &#8212; Lightkurve </title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="lightkurve.LightCurve.to_corrector" href="lightkurve.LightCurve.to_corrector.html" />
    <link rel="prev" title="lightkurve.LightCurve.remove_nans" href="lightkurve.LightCurve.remove_nans.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <p class="title">Lightkurve v2.0</p>
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../whats-new-v2.html">What's new?</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../quickstart.html">Quickstart</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../tutorials/index.html">Tutorials</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">API</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../about/index.html">About</a>
        </li>
        
        
      </ul>


      <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/lightkurve/lightkurve" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="../search.html">Downloading data</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="../lightcurve.html">LightCurve</a>
                    <ul>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.html">lightkurve.LightCurve</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.time.html">lightkurve.LightCurve.time</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.flux.html">lightkurve.LightCurve.flux</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.flux_err.html">lightkurve.LightCurve.flux_err</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.meta.html">lightkurve.LightCurve.meta</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.plot.html">lightkurve.LightCurve.plot</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.scatter.html">lightkurve.LightCurve.scatter</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.errorbar.html">lightkurve.LightCurve.errorbar</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.plot_river.html">lightkurve.LightCurve.plot_river</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.append.html">lightkurve.LightCurve.append</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.copy.html">lightkurve.LightCurve.copy</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.bin.html">lightkurve.LightCurve.bin</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.fill_gaps.html">lightkurve.LightCurve.fill_gaps</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.flatten.html">lightkurve.LightCurve.flatten</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.fold.html">lightkurve.LightCurve.fold</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.normalize.html">lightkurve.LightCurve.normalize</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.remove_nans.html">lightkurve.LightCurve.remove_nans</a>
                        </li>
                    
                        <li class="active">
                            <a href="">lightkurve.LightCurve.remove_outliers</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_corrector.html">lightkurve.LightCurve.to_corrector</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_csv.html">lightkurve.LightCurve.to_csv</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_fits.html">lightkurve.LightCurve.to_fits</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_pandas.html">lightkurve.LightCurve.to_pandas</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_periodogram.html">lightkurve.LightCurve.to_periodogram</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_seismology.html">lightkurve.LightCurve.to_seismology</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_table.html">lightkurve.LightCurve.to_table</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.read.html">lightkurve.LightCurve.read</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.write.html">lightkurve.LightCurve.write</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.estimate_cdpp.html">lightkurve.LightCurve.estimate_cdpp</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.query_solar_system_objects.html">lightkurve.LightCurve.query_solar_system_objects</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.interact_bls.html">lightkurve.LightCurve.interact_bls</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.create_transit_mask.html">lightkurve.LightCurve.create_transit_mask</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.search_neighbors.html">lightkurve.LightCurve.search_neighbors</a>
                        </li>
                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="../foldedlightcurve.html">FoldedLightCurve</a>
                </li>
            
          
            
                <li class="">
                    <a href="../targetpixelfile.html">TargetPixelFile</a>
                </li>
            
          
            
                <li class="">
                    <a href="../periodogram.html">Periodogram</a>
                </li>
            
          
            
                <li class="">
                    <a href="../seismology.html">Seismology</a>
                </li>
            
          
            
                <li class="">
                    <a href="../correctors.html">Correcting systematics</a>
                </li>
            
          
            
                <li class="">
                    <a href="../misc.html">Miscellaneous utilities</a>
                </li>
            
          
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="lightkurve-lightcurve-remove-outliers">
<h1>lightkurve.LightCurve.remove_outliers<a class="headerlink" href="#lightkurve-lightcurve-remove-outliers" title="Permalink to this headline">¶</a></h1>
<dl class="py method">
<dt id="lightkurve.LightCurve.remove_outliers">
<code class="sig-prename descclassname"><span class="pre">LightCurve.</span></code><code class="sig-name descname"><span class="pre">remove_outliers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightkurve.LightCurve.remove_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes outlier data points using sigma-clipping.</p>
<p>This method returns a new <a class="reference internal" href="lightkurve.LightCurve.html#lightkurve.LightCurve" title="lightkurve.LightCurve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LightCurve</span></code></a> object from which data points
are removed if their flux values are greater or smaller than the median
flux by at least <code class="docutils literal notranslate"><span class="pre">sigma</span></code> times the standard deviation.</p>
<p>Sigma-clipping works by iterating over data points, each time rejecting
values that are discrepant by more than a specified number of standard
deviations from a center value. If the data contains invalid values
(NaNs or infs), they are automatically masked before performing the
sigma clipping.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is a convenience wrapper around
<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.stats.sigma_clip()</span></code> and provides the same functionality.
Any extra arguments passed to this method will be passed on to
<code class="docutils literal notranslate"><span class="pre">sigma_clip</span></code>.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sigma</strong><span class="classifier">float</span></dt><dd><p>The number of standard deviations to use for both the lower and
upper clipping limit. These limits are overridden by
<code class="docutils literal notranslate"><span class="pre">sigma_lower</span></code> and <code class="docutils literal notranslate"><span class="pre">sigma_upper</span></code>, if input. Defaults to 5.</p>
</dd>
<dt><strong>sigma_lower</strong><span class="classifier">float or None</span></dt><dd><p>The number of standard deviations to use as the lower bound for
the clipping limit. Can be set to float(‘inf’) in order to avoid
clipping outliers below the median at all. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> then the
value of <code class="docutils literal notranslate"><span class="pre">sigma</span></code> is used. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
</dd>
<dt><strong>sigma_upper</strong><span class="classifier">float or None</span></dt><dd><p>The number of standard deviations to use as the upper bound for
the clipping limit. Can be set to float(‘inf’) in order to avoid
clipping outliers above the median at all. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> then the
value of <code class="docutils literal notranslate"><span class="pre">sigma</span></code> is used. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
</dd>
<dt><strong>return_mask</strong><span class="classifier">bool</span></dt><dd><p>Whether or not to return a mask (i.e. a boolean array) indicating
which data points were removed. Entries marked as <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> in the
mask are considered outliers.  This mask is not returned by default.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict</span></dt><dd><p>Dictionary of arguments to be passed to <a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.stats.sigma_clip.html#astropy.stats.sigma_clip" title="(in Astropy v4.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.stats.sigma_clip</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>clean_lc</strong><span class="classifier"><a class="reference internal" href="lightkurve.LightCurve.html#lightkurve.LightCurve" title="lightkurve.LightCurve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LightCurve</span></code></a></span></dt><dd><p>A new light curve object from which outlier data points have been
removed.</p>
</dd>
<dt><strong>outlier_mask</strong><span class="classifier">NumPy array, optional</span></dt><dd><p>Boolean array flagging which cadences were removed.
Only returned if <code class="xref py py-obj docutils literal notranslate"><span class="pre">return_mask=True</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>This example generates a new light curve in which all points
that are more than 1 standard deviation from the median are removed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">flux</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lc_clean</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">remove_outliers</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lc_clean</span><span class="o">.</span><span class="n">time</span>
<span class="go">&lt;Time object: scale=&#39;tdb&#39; format=&#39;jd&#39; value=[1. 3. 5.]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lc_clean</span><span class="o">.</span><span class="n">flux</span>
<span class="go">&lt;Quantity [1., 1., 1.]&gt;</span>
</pre></div>
</div>
<p>Instead of specifying <code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma</span></code>, you may specify separate <code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma_lower</span></code>
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma_upper</span></code> parameters to remove only outliers above or below
the median. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">flux</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lc_clean</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">remove_outliers</span><span class="p">(</span><span class="n">sigma_lower</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">sigma_upper</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lc_clean</span><span class="o">.</span><span class="n">time</span>
<span class="go">&lt;Time object: scale=&#39;tdb&#39; format=&#39;jd&#39; value=[1. 3. 4. 5.]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lc_clean</span><span class="o">.</span><span class="n">flux</span>
<span class="go">&lt;Quantity [    1.,     1., -1000.,     1.]&gt;</span>
</pre></div>
</div>
<p>Optionally, you may use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">return_mask</span></code> parameter to return a boolean
array which flags the outliers identified by the method. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lc_clean</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">remove_outliers</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span>
<span class="go">array([False,  True, False,  True, False])</span>
</pre></div>
</div>
</dd></dl>

</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="lightkurve.LightCurve.remove_nans.html" title="previous page">lightkurve.LightCurve.remove_nans</a>
    <a class='right-next' id="next-link" href="lightkurve.LightCurve.to_corrector.html" title="next page">lightkurve.LightCurve.to_corrector</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-69171-9', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright Lightkurve developers.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>