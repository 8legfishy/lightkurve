
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lightkurve.LightCurve.estimate_cdpp &#8212; Lightkurve </title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="lightkurve.LightCurve.query_solar_system_objects" href="lightkurve.LightCurve.query_solar_system_objects.html" />
    <link rel="prev" title="lightkurve.LightCurve.write" href="lightkurve.LightCurve.write.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <p class="title">Lightkurve v2.0rc1</p>
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../whats-new-v2.html">What's new?</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../quickstart.html">Quickstart</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../tutorials/index.html">Tutorials</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">API</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../about/index.html">About</a>
        </li>
        
        
      </ul>


      <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/KeplerGO/Lightkurve" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="../search.html">Downloading data</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="../lightcurve.html">LightCurve</a>
                    <ul>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.html">lightkurve.LightCurve</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.time.html">lightkurve.LightCurve.time</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.flux.html">lightkurve.LightCurve.flux</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.flux_err.html">lightkurve.LightCurve.flux_err</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.meta.html">lightkurve.LightCurve.meta</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.plot.html">lightkurve.LightCurve.plot</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.scatter.html">lightkurve.LightCurve.scatter</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.errorbar.html">lightkurve.LightCurve.errorbar</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.plot_river.html">lightkurve.LightCurve.plot_river</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.append.html">lightkurve.LightCurve.append</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.copy.html">lightkurve.LightCurve.copy</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.bin.html">lightkurve.LightCurve.bin</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.fill_gaps.html">lightkurve.LightCurve.fill_gaps</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.flatten.html">lightkurve.LightCurve.flatten</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.fold.html">lightkurve.LightCurve.fold</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.normalize.html">lightkurve.LightCurve.normalize</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.remove_nans.html">lightkurve.LightCurve.remove_nans</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.remove_outliers.html">lightkurve.LightCurve.remove_outliers</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_corrector.html">lightkurve.LightCurve.to_corrector</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_csv.html">lightkurve.LightCurve.to_csv</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_fits.html">lightkurve.LightCurve.to_fits</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_pandas.html">lightkurve.LightCurve.to_pandas</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_periodogram.html">lightkurve.LightCurve.to_periodogram</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_seismology.html">lightkurve.LightCurve.to_seismology</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.to_table.html">lightkurve.LightCurve.to_table</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.read.html">lightkurve.LightCurve.read</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.write.html">lightkurve.LightCurve.write</a>
                        </li>
                    
                        <li class="active">
                            <a href="">lightkurve.LightCurve.estimate_cdpp</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.query_solar_system_objects.html">lightkurve.LightCurve.query_solar_system_objects</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.interact_bls.html">lightkurve.LightCurve.interact_bls</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.create_transit_mask.html">lightkurve.LightCurve.create_transit_mask</a>
                        </li>
                    
                        <li class="">
                            <a href="lightkurve.LightCurve.search_neighbors.html">lightkurve.LightCurve.search_neighbors</a>
                        </li>
                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="../foldedlightcurve.html">FoldedLightCurve</a>
                </li>
            
          
            
                <li class="">
                    <a href="../targetpixelfile.html">TargetPixelFile</a>
                </li>
            
          
            
                <li class="">
                    <a href="../periodogram.html">Periodogram</a>
                </li>
            
          
            
                <li class="">
                    <a href="../seismology.html">Seismology</a>
                </li>
            
          
            
                <li class="">
                    <a href="../correctors.html">Correcting systematics</a>
                </li>
            
          
            
                <li class="">
                    <a href="../misc.html">Miscellaneous utilities</a>
                </li>
            
          
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="lightkurve-lightcurve-estimate-cdpp">
<h1>lightkurve.LightCurve.estimate_cdpp<a class="headerlink" href="#lightkurve-lightcurve-estimate-cdpp" title="Permalink to this headline">¶</a></h1>
<dl class="py method">
<dt id="lightkurve.LightCurve.estimate_cdpp">
<code class="sig-prename descclassname">LightCurve.</code><code class="sig-name descname">estimate_cdpp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">transit_duration</span><span class="o">=</span><span class="default_value">13</span></em>, <em class="sig-param"><span class="n">savgol_window</span><span class="o">=</span><span class="default_value">101</span></em>, <em class="sig-param"><span class="n">savgol_polyorder</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">5.0</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a><a class="headerlink" href="#lightkurve.LightCurve.estimate_cdpp" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the CDPP noise metric using the Savitzky-Golay (SG) method.</p>
<p>A common estimate of the noise in a lightcurve is the scatter that
remains after all long term trends have been removed. This is the idea
behind the Combined Differential Photometric Precision (CDPP) metric.
The official Kepler Pipeline computes this metric using a wavelet-based
algorithm to calculate the signal-to-noise of the specific waveform of
transits of various durations. In this implementation, we use the
simpler “sgCDPP proxy algorithm” discussed by Gilliland et al
(2011ApJS..197….6G) and Van Cleve et al (2016PASP..128g5002V).</p>
<dl class="simple">
<dt>The steps of this algorithm are:</dt><dd><ol class="arabic simple">
<li><p>Remove low frequency signals using a Savitzky-Golay filter with
window length <code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_window</span></code> and polynomial order <code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_polyorder</span></code>.</p></li>
<li><p>Remove outliers by rejecting data points which are separated from
the mean by <code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma</span></code> times the standard deviation.</p></li>
<li><p>Compute the standard deviation of a running mean with
a configurable window length equal to <code class="xref py py-obj docutils literal notranslate"><span class="pre">transit_duration</span></code>.</p></li>
</ol>
</dd>
</dl>
<p>We use a running mean (as opposed to block averaging) to strongly
attenuate the signal above 1/transit_duration whilst retaining
the original frequency sampling.  Block averaging would set the Nyquist
limit to 1/transit_duration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>transit_duration</strong><span class="classifier">int, optional</span></dt><dd><p>The transit duration in units of number of cadences. This is the
length of the window used to compute the running mean. The default
is 13, which corresponds to a 6.5 hour transit in data sampled at
30-min cadence.</p>
</dd>
<dt><strong>savgol_window</strong><span class="classifier">int, optional</span></dt><dd><p>Width of Savitsky-Golay filter in cadences (odd number).
Default value 101 (2.0 days in Kepler Long Cadence mode).</p>
</dd>
<dt><strong>savgol_polyorder</strong><span class="classifier">int, optional</span></dt><dd><p>Polynomial order of the Savitsky-Golay filter.
The recommended value is 2.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float, optional</span></dt><dd><p>The number of standard deviations to use for clipping outliers.
The default is 5.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>cdpp</strong><span class="classifier">float</span></dt><dd><p>Savitzky-Golay CDPP noise metric in units parts-per-million (ppm).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This implementation is adapted from the Matlab version used by
Jeff van Cleve but lacks the normalization factor used there:
svn+ssh://murzim/repo/so/trunk/Develop/jvc/common/compute_SG_noise.m</p>
</dd></dl>

</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="lightkurve.LightCurve.write.html" title="previous page">lightkurve.LightCurve.write</a>
    <a class='right-next' id="next-link" href="lightkurve.LightCurve.query_solar_system_objects.html" title="next page">lightkurve.LightCurve.query_solar_system_objects</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-69171-9', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright Lightkurve developers.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>